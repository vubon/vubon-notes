<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=192x192 href=/android-chrome-192x192.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><meta name=keywords content="Vubon,Vubon Roy,Vubon Notes,Engineering,Blog,Tutorials,Technology,Coding,Python,DevOps,Hugo,GitHub Pages"><meta name=description content><title>Experiment with GIN index of PostgreSQL DB | Vubon Notes
</title><link rel=canonical href=https://vubon.me/posts/experiment-with-gin-index-of-postgresql-db/><meta property="og:url" content="https://vubon.me/posts/experiment-with-gin-index-of-postgresql-db/"><meta property="og:site_name" content="Vubon Notes"><meta property="og:title" content="Experiment with GIN index of PostgreSQL DB"><meta property="og:description" content='PostgreSQL provides the index methods B-tree, hash, GiST, SP-GiST, GIN, and BRIN. Users can also define their own index methods, but that is fairly complicated. In this article, I will discuss the GIN index. GIN index is a very useful index method for a query, count, etc.
Use cases GIN index:
Full-Text search(tsvector) Array Data Type JSONB What is the Gin index? From the Docs "GIN stands for Generalized Inverted Index. GIN is designed for handling cases where the items to be indexed are composite values, and the queries to be handled by the index need to search for element values that appear within the composite items. For example, the items could be documents, and the queries could be searches for documents containing specific words." ![GIN index diagram](/images/GIN-index-1024x597.jpg) Image credit: Cybertec Postgresql Create test data'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-04-04T14:49:16+00:00"><meta property="article:modified_time" content="2019-04-06T10:45:31+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Person","name":"Vubon Roy","url":"https://vubon.me/","sameAs":["https://github.com/vubon","mailto:vubon.roy@gmail.com"],"description":"Vubon Notes is the personal blog of Vubon Roy, sharing engineering notes, tutorials, and experiments in technology, coding, Python, DevOps, Hugo, and more."}</script><link rel=stylesheet href=/assets/combined.min.329ddbca468aad36d8c3e211b202549594b5e9189d75140a974b8aa996a172de.css media=all></head><body class=auto><div class=content><header><div class=header><h1 class=header-title><a href=https://vubon.me/>Vubon Notes</a>
<span class=header-social><a href=https://github.com/vubon target=_blank rel="noopener noreferrer" title=github><svg width="20" height="20" viewBox="0 0 24 24" fill="currentcolor"><path d="M12 0C5.374.0.0 5.373.0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931.0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176.0.0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221.0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg>
</a><a href=mailto:vubon.roy@gmail.com target=_blank rel="noopener noreferrer" title=email><svg width="20" height="20" viewBox="0 0 24 24" fill="currentcolor"><path d="M20 4H4c-1.1.0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"/></svg></a></span></h1><div class=header-menu><p class=small><a href=/>/home</a></p><p class=small><a href=/posts/>/blog</a></p></div></div><style>.header-social{display:inline-flex;gap:10px;margin-left:15px;vertical-align:middle}.header-social a{display:inline-flex;align-items:center;opacity:.7;transition:opacity .2s}.header-social a:hover{opacity:1}.header-social svg{vertical-align:middle}</style></header><main class=main><div><article><header class=single-intro-container><h1 class=single-title>Experiment with GIN index of PostgreSQL DB</h1><div class=single-subsummary><div><p class=single-date><time datetime=2019-04-04T14:49:16+00:00>April 4, 2019</time></p></div></div></header><div class=single-content><p>PostgreSQL provides the index methods B-tree, hash, GiST, SP-GiST, GIN, and BRIN. Users can also define their own index methods, but that is fairly complicated. In this article, I will discuss the GIN index. GIN index is a very useful index method for a query, count, etc.</p><p><strong>Use cases GIN index:</strong></p><ul><li>Full-Text search(tsvector)</li><li>Array Data Type</li><li>JSONB</li></ul><strong>What is the Gin index?</strong>
From the <a href=https://www.postgresql.org/docs/9.6/gin-intro.html>Docs</a><blockquote><em>"GIN stands for Generalized Inverted Index. GIN is designed for handling cases where the items to be indexed are composite values, and the queries to be handled by the index need to search for element values that appear within the composite items. For example, the items could be documents, and the queries could be searches for documents containing specific words."</em></blockquote>![GIN index diagram](/images/GIN-index-1024x597.jpg)<p>Image credit: <a href=https://www.cybertec-postgresql.com>Cybertec Postgresql</a>
<strong>Create test data</strong></p><p>The example given is done with PostgreSQL9.6 version (psql client 11.2 ) and Ubuntu 18.04. Machine hardware is RAM 8 GB and Core i5.
<strong></strong>Create a table with random data by following SQL command over psql client.</p><pre class="lang:pgsql decode:true">CREATE TABLE test_table as select s, md5(random()::text) from generate_series(1, 10000000) s;</pre><p>By this created two columns. first one is <code>s</code> and another one is <code>md5</code>. Now let&rsquo;s search a text from our generate data.</p><pre class="lang:pgsql decode:true">select * from new_test where md5 ilike '%b9e2747b6a98a277c2449f2a8969bd1e%';</pre><p>I searched the last row data from the table. It quite slow brings to our result. The query time is 10132.924 ms or almost 10 seconds without GIN index.</p><p>Let&rsquo;s create GIN an index of the md5 column. By following SQL command.</p><pre class="lang:pgsql decode:true">CREATE EXTENSION IF NOT EXISTS pg_trgm;CREATE INDEX new_table_search_idx ON new_test USING gin(md5 gin_trgm_ops);
</pre><p>It will take time for creating index 10000000 rows.
Now recall the query.</p><pre class="lang:pgsql decode:true">select * from new_test where md5 ilike '%b9e2747b6a98a277c2449f2a8969bd1e%';</pre><p>It will take only a few milliseconds. Second query time is 62.219 ms. Obviously, this is a major improvement in our query.</p><p>To be continued &mldr;</p></div></article><div class=single-pagination><hr><div class=flexnowrap><div class=single-pagination-prev><div class=single-pagination-container-prev><div class=single-pagination-text>←</div><div class=single-pagination-text><a href=/posts/string-in-python/>String in Python</a></div></div></div><div class=single-pagination-next><div class=single-pagination-container-next><div class=single-pagination-text><a href=/posts/clock-arithmetic-or-modular-arithmetic/>Clock Arithmetic or Modular Arithmetic</a></div><div class=single-pagination-text>→</div></div></div></div><hr></div><div class=back-to-top><a href=#top>back to top</a></div></div></main></div><footer><p>Powered by
<a href=https://gohugo.io/>Hugo</a>
and
<a href=https://github.com/tomfran/typo>tomfran/typo</a></p></footer></body><script src=/js/theme-switch.js></script><script defer src=/js/copy-code.js></script></html>